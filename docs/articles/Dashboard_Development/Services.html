<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Publicly Funded Services • DSPGDisability</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Publicly Funded Services">
<meta property="og:description" content="DSPGDisability">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">DSPGDisability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title=""></span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Dashboards
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/DemographicDashboard.html">Demographics</a>
    </li>
    <li>
      <a href="../../articles/DemographicsWorkingAge.html">Demographics for Working Age</a>
    </li>
    <li>
      <a href="../../articles/EmploymentLaborDashboard.html">Employment and Labor Services</a>
    </li>
    <li>
      <a href="../../articles/ServicesDashboard.html">Publicly Funded Services</a>
    </li>
    <li>
      <a href="../../articles/ExpendituresDashboard.html">County Expenditures by Service Area and Fiscal Year</a>
    </li>
    <li>
      <a href="../../articles/MhdsServicesDashboard.html">Mental Health and Disability Services</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Dashboard Development and Supplements
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/Dashboard_Development/DataLiteratureReview.html">Data Sources and Literature Review</a>
    </li>
    <li>
      <a href="../../articles/Dashboard_Development/Demographics.html">Demographic Information</a>
    </li>
    <li>
      <a href="../../articles/Dashboard_Development/EmploymentAndLabor.html">Employment and Labor Participation</a>
    </li>
    <li>
      <a href="../../articles/Dashboard_Development/Services.html">Services</a>
    </li>
    <li>
      <a href="../../articles/Dashboard_Development/Expenditures.html">Expenditures</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DSPG2021/DHR-Disabilities/" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Publicly Funded Services</h1>
            
      
      
      <div class="hidden name"><code>Services.Rmd</code></div>

    </div>

    
    
<p>This vignette explains the R script used to transform the IVRS data
used in the Publicly Funded Services dashboard.</p>
<div class="section level2">
<h2 id="libraries-and-datasets">Libraries and Datasets<a class="anchor" aria-label="anchor" href="#libraries-and-datasets"></a>
</h2>
<p>Here tidyverse is used for functions used such as dplyr and mutate.
Also the respective data files are loaded in as well.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load in IVRS adjusted inflation file</span></span>
<span><span class="va">IVRS_data_old</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">TRUE</span>, stringsAsFactors<span class="op">=</span><span class="cn">FALSE</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#load in IVRS FFY2020 file</span></span>
<span><span class="va">IVRS_data_new_2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">TRUE</span>, stringsAsFactors<span class="op">=</span><span class="cn">FALSE</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span>,fileEncoding<span class="op">=</span><span class="st">"UTF-8-BOM"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#load in IVRS FFY2021 file</span></span>
<span><span class="va">IVRS_data_new_2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">TRUE</span>, stringsAsFactors<span class="op">=</span><span class="cn">FALSE</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="client-location-cleaning">Client Location Cleaning<a class="anchor" aria-label="anchor" href="#client-location-cleaning"></a>
</h2>
<p>One of the things done to this data set is parsing out location
information from the Client Location column. The column is initially in
the format of “city, state, zip code”.</p>
<p>After parsing, we now have the new columns, Client City, Client
State, Client Zip Code, and Client Zip Code Extra Info for zip codes
that were longer than 5 digits.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Initial split on comma to get City</span></span>
<span>    <span class="va">IVRS_data_transformed</span> <span class="op">&lt;-</span> <span class="va">IVRS_data_old</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                              <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="st">'Client Location'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Client City'</span>, <span class="st">'Client State Zip Code'</span><span class="op">)</span>, <span class="st">','</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Remove any leading and trailing whitespace</span></span>
<span>    <span class="va">IVRS_data_transformed</span><span class="op">$</span><span class="st">'Client City'</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_trim.html" class="external-link">str_trim</a></span><span class="op">(</span><span class="va">IVRS_data_transformed</span><span class="op">$</span><span class="st">'Client City'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Secondary split to get State and Zipcode</span></span>
<span>    <span class="va">IVRS_data_transformed</span> <span class="op">&lt;-</span> <span class="va">IVRS_data_transformed</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                              <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="st">'Client State Zip Code'</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Client State'</span>,<span class="st">'Client Zip Code'</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">"\\s+(?=\\S*$)"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Remove any leading and trailing whitespace</span></span>
<span>    <span class="va">IVRS_data_transformed</span><span class="op">$</span><span class="st">'Client State'</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_trim.html" class="external-link">str_trim</a></span><span class="op">(</span><span class="va">IVRS_data_transformed</span><span class="op">$</span><span class="st">'Client State'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Split Zip code into 5 digit format and extra information</span></span>
<span>    <span class="va">IVRS_data_transformed</span> <span class="op">&lt;-</span> <span class="va">IVRS_data_transformed</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                              <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="st">'Client Zip Code'</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Client Zip Code'</span>,<span class="st">'Client Zip Code Extra Info'</span><span class="op">)</span>,sep<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Remove any leading and trailing whitespace</span></span>
<span>    <span class="va">IVRS_data_transformed</span><span class="op">$</span><span class="st">'Client Zip Code'</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_trim.html" class="external-link">str_trim</a></span><span class="op">(</span><span class="va">IVRS_data_transformed</span><span class="op">$</span><span class="st">'Client Zip Code'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove '-' from extra zip code info</span></span>
<span>    <span class="va">IVRS_data_transformed</span><span class="op">$</span><span class="st">'Client Zip Code Extra Info'</span> <span class="op">&lt;-</span> </span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span><span class="va">IVRS_data_transformed</span><span class="op">$</span><span class="st">'Client Zip Code Extra Info'</span>, <span class="st">"[^[:alnum:]]"</span>, <span class="st">""</span><span class="op">)</span></span>
<span>    </span>
<span><span class="co"># Remove any leading and trailing whitespace</span></span>
<span>    <span class="va">IVRS_data_transformed</span><span class="op">$</span><span class="st">'Client Zip Code Extra Info'</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_trim.html" class="external-link">str_trim</a></span><span class="op">(</span><span class="va">IVRS_data_transformed</span><span class="op">$</span><span class="st">'Client Zip Code Extra Info'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="joining-extra-information-for-cases">Joining Extra Information for Cases<a class="anchor" aria-label="anchor" href="#joining-extra-information-for-cases"></a>
</h2>
<p>The next thing done is joining extra information that was obtained
for cases in 2020 - 2021, such as academic participation, to the data
set.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Append 2021 to 2020 data</span></span>
<span>    <span class="va">appended</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">IVRS_data_new_2021</span>, <span class="va">IVRS_data_new_2020</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># left join data including only new columns</span></span>
<span>    <span class="va">IVRS_merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">IVRS_data_transformed</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">IVRS_data_new_2020</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">43</span><span class="op">:</span><span class="fl">53</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Case ID"</span> <span class="op">=</span> <span class="st">"CaseID"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dealing-with-county-formatting">Dealing with county formatting<a class="anchor" aria-label="anchor" href="#dealing-with-county-formatting"></a>
</h2>
<p>One of Iowa’s counties is O’Brien county which has a pesky apostrophe
that gets dropped or displayed as strange characters when importing and
saving data sets.</p>
<p>To solve this, the incorrect name is restored to the correct name and
the R script is saved with UTF-8 encoding as to not lose the strange
characters typed into the R script.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Renames Iowa county O'Brien to have ' instead of Oâ€™Brien (Double check wording in the data as these characters consistently incorrectly save)</span></span>
<span>    <span class="co"># !!IMPORTANT!! File needs to be saved using UTF-8 encoding for the special characters to not disappear. </span></span>
<span>    <span class="co">#               This can be changed in File -&gt; Save with encoding -&gt; Choose Encoding -&gt; UTF-8</span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Client County'</span><span class="op">[</span><span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Client County'</span> <span class="op">==</span> <span class="st">'Oâ€™Brien'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"O'Brien"</span>   </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="updating-state-column">Updating State Column<a class="anchor" aria-label="anchor" href="#updating-state-column"></a>
</h2>
<p>There are a number of inconsistencies in the data when it comes to
state naming conventions.</p>
<p>Some states are full names, others are abbreviations, and some are a
strange combination of the two.</p>
<p>This section deals with those inconsistencies and would potentially
need updating in the future for other cases.</p>
<p>In the end, states are converted to be the full state name.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Changes state names to abbreviations</span></span>
<span></span>
<span>    <span class="va">stateNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">IVRS_merged</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    </span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">state</span> <span class="kw">in</span> <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Client State'</span><span class="op">)</span><span class="op">{</span></span>
<span>      </span>
<span>      <span class="va">state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_trim.html" class="external-link">str_trim</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span></span>
<span>      <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>      </span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">stateNames</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="st">'ArKS'</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">stateNames</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'Arkansas'</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="st">'ARKS'</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">stateNames</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'Arkansas'</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="st">'District of Columbia'</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">stateNames</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">state</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="st">'Puerto Rico'</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">stateNames</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="st">'West VA'</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">stateNames</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'West Virginia'</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">stateNames</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">state</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">stateNames</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">state.name</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="va">state</span>, <span class="va">state.abb</span><span class="op">)</span><span class="op">]</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Client State'</span> <span class="op">&lt;-</span> <span class="va">stateNames</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="wage-calculations">Wage Calculations<a class="anchor" aria-label="anchor" href="#wage-calculations"></a>
</h2>
<p>One of the most important fields in this data set is the wage
information.</p>
<p>This data allows us to determine how effective the IVRS program
is.</p>
<p>Please read the comments below for more detail on the calculations
done.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Change wage at application and closure values to correctly calculate wage change</span></span>
<span>    <span class="co">#</span></span>
<span>    <span class="co"># Note: Wage change is computed by the formula (Wage (Closure) - Wage (Application) = Wage Change).</span></span>
<span>    <span class="co">#</span></span>
<span>    <span class="co">#       NA's in the wage data indicates that the client was unemployed. </span></span>
<span>    <span class="co">#       </span></span>
<span>    <span class="co">#       To make the formula accurate, Wage (Application) NA's  are changed to 0 so as to correctly calculate if there was a wage increase. </span></span>
<span>    <span class="co">#       (i.e. client A indicates they are unemployed at the start of application [Wage (Application)], and at the end their wage was $15 an hour [Wage (Closure)]. </span></span>
<span>    <span class="co">#       If unemployed was left at NA then the formula would return NA since any NA value in an equation defaults to equaling NA in R. However since</span></span>
<span>    <span class="co">#       it is being set to 0, this will correctly compute a $15 increase in wage change.)</span></span>
<span>    <span class="co">#</span></span>
<span>    <span class="co">#       Also vice versa, any 0's in Wage (Closure) were changed to NA so that the formula would output NA to indicate that the wage change</span></span>
<span>    <span class="co">#       resulted in unemployment.</span></span>
<span>    <span class="co">#</span></span>
<span></span>
<span>    </span>
<span>    <span class="co"># hourly</span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Hourly Wage (Application)'</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Hourly Wage (Application)'</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Hourly Wage (Closure)'</span><span class="op">[</span><span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Hourly Wage (Closure)'</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    </span>
<span>    <span class="co">#monthly</span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Monthly Wage (Application)'</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Monthly Wage (Application)'</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Monthly Wage (Closure)'</span><span class="op">[</span><span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Monthly Wage (Closure)'</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    </span>
<span>    <span class="co">#annually</span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Annual Wage (Application)'</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Annual Wage (Application)'</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Annual Wage (Closure)'</span><span class="op">[</span><span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Annual Wage (Closure)'</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    </span>
<span><span class="co"># Recalculated wage change fields</span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Hourly Wage Change'</span> <span class="op">&lt;-</span> <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Hourly Wage (Closure)'</span> <span class="op">-</span> <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Hourly Wage (Application)'</span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Monthly Wage Change'</span> <span class="op">&lt;-</span> <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Monthly Wage (Closure)'</span> <span class="op">-</span> <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Monthly Wage (Application)'</span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Annual Wage Change'</span> <span class="op">&lt;-</span> <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Annual Wage (Closure)'</span> <span class="op">-</span> <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Annual Wage (Application)'</span></span>
<span></span>
<span><span class="co"># Creates new columns for whether there was a wage increase, no change, decrease, or unemployed</span></span>
<span>    <span class="va">IVRS_merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">IVRS_merged</span>, <span class="st">'Hourly Wage Change Category'</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Hourly Wage Change'</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Decrease"</span>,</span>
<span>      <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Hourly Wage Change'</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"No Change"</span>,</span>
<span>      <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Hourly Wage Change'</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Increase"</span>,</span>
<span>                                                                                            <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Hourly Wage Change'</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Unemployed"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">IVRS_merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">IVRS_merged</span>, <span class="st">'Monthly Wage Change Category'</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Monthly Wage Change'</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Decrease"</span>,</span>
<span>      <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Monthly Wage Change'</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"No Change"</span>,</span>
<span>      <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Monthly Wage Change'</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Increase"</span>,</span>
<span>                                                                                            <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Monthly Wage Change'</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Unemployed"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">IVRS_merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">IVRS_merged</span>, <span class="st">'Annual Wage Change Category'</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Annual Wage Change'</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Decrease"</span>,</span>
<span>      <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Annual Wage Change'</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"No Change"</span>,</span>
<span>      <span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Annual Wage Change'</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Increase"</span>,</span>
<span>                                                                                            <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">IVRS_merged</span><span class="op">$</span><span class="st">'Annual Wage Change'</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Unemployed"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="formatting-office-areas">Formatting Office Areas<a class="anchor" aria-label="anchor" href="#formatting-office-areas"></a>
</h2>
<p>Office areas are in the format “Office Name (Office Number)” with
some having an added “(inactive)” if the office area is no longer
active.</p>
<p>This code removes the extra info and leaves only the office areas
name.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remove numbers from office areas</span></span>
<span>    <span class="va">IVRS_merged</span><span class="op">$</span><span class="va">`Office Area`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\s*\\([^\\)]+\\)"</span>,<span class="st">""</span>,<span class="va">IVRS_merged</span><span class="op">$</span><span class="va">`Office Area`</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="writing-cleaned-data-to-file">Writing Cleaned Data to File<a class="anchor" aria-label="anchor" href="#writing-cleaned-data-to-file"></a>
</h2>
<p>Lastly the now clean data is written to a csv file for use in
Tableau.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># write to file</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">IVRS_merged</span>, <span class="st">"C:/Users/joelm/Documents/GitHub/DHR-Disabilities/Data Exploration/Datasets/IVRS Data/Cleaned_Closed_Iowa_Vocational_Rehabilitation_Cases.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Harun Celik.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
