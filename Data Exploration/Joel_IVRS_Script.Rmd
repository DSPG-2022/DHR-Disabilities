---
title: "Joel_IVRS_Script"
author: "Harun"
date: '2022-06-08'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Libraries
library(ggplot2)
library(dplyr)

# Read in data
IVRS <- read.csv("Data/Closed_Iowa_Vocational_Rehabilitation_Cases.csv")
IDB <- read.csv("Data/Successful_Employment_for_Blind_Iowans_by_Federal_Fiscal_Year.csv")
```

# Exploration of the Iowa Vocational Rehabilitation Services (IVRS) Data

This data comes from the [data.iowa.gov](https://https://data.iowa.gov/Vocational-Rehabilitation/Closed-Iowa-Vocational-Rehabilitation-Cases/gcya-t3y9) website and provides information on closed cases where the individual received services from IVRS. This data includes cases closed after October 1, 2008.

## Number of Cases by Gender

This section looks at the number of cases for each gender. 

From this graph we can see that there were more cases for men although it can be noted that the number of cases for women isn't to far off from the total of men's cases.

```{r Number of Cases by Gender, echo=FALSE}
gender.cases <- IVRS %>%
  count(Gender, name = "Total.Cases") %>%
  group_by(Gender)
  

ggplot(data = gender.cases, aes(x = Gender, y = Total.Cases)) +
  geom_bar(fill = "orange", stat = "identity") +
  geom_text(aes(label=Total.Cases), vjust=-0.5) +
  xlab("Gender") +
  ylab("Number of Cases")
```

## Number of Cases by Age

### Age at Start of Application

This section looks at the number of cases by the age of the client when the case was started.

Initially I put the data into a bar graph but it is difficult to read the various ages and the bar labels are crowded. 

```{r Number of Cases by Age at Start, echo=FALSE}
age.start.cases <- IVRS %>%
  count(Age.at.Application, name = "Total.Cases") %>%
  group_by(Age.at.Application)

ggplot(data = age.start.cases, aes(x = as.factor(Age.at.Application), y = Total.Cases)) +
  geom_bar(fill = "orange", stat = "identity") +
  geom_text(aes(label=Total.Cases), vjust=-0.5) +
  xlab("Age at Start of Application") +
  ylab("Number of Cases")
```

I then looked at a table of the data sorted by the number of cases which was more helpful.

From this table we can see that the majority of cases were from those in their mid teen to mid twenties (as could be seen in the bar graph). 

```{r, echo=FALSE}
age.start.cases %>% arrange(desc(Total.Cases))
```

### Age at Closure of Application

This section looks at the number of cases by the age of the client when the case was closed.

As before I put the data into a bar graph but again it is difficult to read the various ages and the bar labels are crowded. We do however see the same trend as before of the majority of those with closed cases are in their mid teen to mid twenties.



```{r Number of Cases by Age at Closure, echo=FALSE}
age.closure.cases <- IVRS %>%
  count(Age.at.Closure, name = "Total.Cases") %>%
  group_by(Age.at.Closure)
  

ggplot(data = age.closure.cases, aes(x = Age.at.Closure, y = Total.Cases)) +
  geom_bar(fill = "orange", stat = "identity") +
  xlab("Age at Closure of Application") +
  ylab("Number of Cases")
```

I then looked at a table of the data sorted by the number of cases.

From this table we can see that the majority of cases were actually from those in their late teen to late twenties.

```{r, echo=FALSE}
age.closure.cases %>% arrange(desc(Total.Cases))
```

### Age Span of Clients

I then looked at the age span of the cases by subtracting the persons age at the end of their case from their age at the start of the case.

We can see that the majority of the cases were only open for 1 - 3 years. This makes sense since from our previous graphs it appeared that those in the majority age range for their case start age were in the majority for their case closed age.

```{r Age Spans, echo=FALSE}
age.span <- transform(IVRS, Age.Span = Age.at.Closure - Age.at.Application)

age.span <- age.span %>%
  count(Age.Span, name = "Total") %>%
  group_by(Age.Span)
  

ggplot(data = age.span, aes(x = as.factor(Age.Span), y = Total)) +
  geom_bar(fill = "orange", stat = "identity") +
  geom_text(aes(label=Total), vjust=-0.5) +
  xlab("Age Span") +
  ylab("Number of Cases")
```

## Minority Groups

This section looks at the minority groups. 

We can see that most of the cases were non-minority clients.

```{r Minority Groups, echo=FALSE}
minority.group.cases <- IVRS %>%
  count(Minority.Group, name = "Total.Cases") %>%
  group_by(Minority.Group)
  

ggplot(data = minority.group.cases, aes(x = Minority.Group, y = Total.Cases)) +
  geom_bar(fill = "orange", stat = "identity") +
  xlab("Minority Group") +
  ylab("Number of Cases")
```

## Monthly Cases

This section looks at how long the closed cases were opened. 

I created a bar chart to view this data, however there are a large number of data points and it is difficult to see specifics. We can see that the majority of cases were opened between about 10 - 50 months (about 1 - 5 years).

```{r Monthly Cases, echo=FALSE}
months.opened <- IVRS %>%
  count(Months.Case.Open, name = "Total.Cases") %>%
  group_by(Months.Case.Open)
  

ggplot(data = months.opened, aes(x = Months.Case.Open, y = Total.Cases)) +
  geom_bar(fill = "orange", stat = "identity") +
  xlab("Number of Months Opened") +
  ylab("Number of Cases")
```

Creating a sorted table shows that most of the cases were opened for about 1 $\frac{1}{2}$ - 2 years.

```{r, echo=FALSE}
months.opened %>% arrange(desc(Total.Cases))
```

## Yearly Cases

This section looks at how many cases were closed each year. 

We can see that the number of closed cases has remained relatively the same over the course of the data sets history.

```{r Yearly Cases, echo=FALSE}
yearly.cases <- IVRS %>%
  count(Federal.Fiscal.Year, name = "Total.Cases") %>%
  group_by(Federal.Fiscal.Year)
  

ggplot(data = yearly.cases, aes(x = as.factor(Federal.Fiscal.Year), y = Total.Cases)) +
  geom_bar(fill = "orange", stat = "identity") +
  geom_text(aes(label=Total.Cases), vjust=-0.5) +
  xlab("Year") +
  ylab("Number of Cases")
```

## Date Span

This section looks at the span of the cases by start date of application to date of closure.

```{r}

```

## Cases by Client County

This section looks at the clients for each case by county they are from. 

Initially I attempted to make a bar chart hoping it would hold all of Iowa's 99 counties. However I learned that there are many counties in the data set outside of Iowa which made it almost impossible to view that data in a bar graph format.

```{r Cases by Client County, echo=FALSE}
county.cases <- IVRS %>%
  count(Client.County, name = "Total.Cases") %>%
  group_by(Client.County)
  

ggplot(data = county.cases, aes(x = Client.County, y = Total.Cases)) +
  geom_bar(fill = "orange", stat = "identity") +
  xlab("County") +
  ylab("Number of Cases") +
  theme(axis.text.x = element_text(angle = 90))
```

I then opted to make a table showing the number of closed cases for each county sorted by those with the highest number of cases. From this table we can see that Polk and Linn counties have the most closed cases. A quick [Google search](https://www.iowa-demographics.com/counties_by_population) showed from the 2020 American Community Survey (ACS) data that the counties with the highest population were Polk and Linn so this data aligns with what we would expect.
```{r, echo=FALSE}
county.cases %>% arrange(desc(Total.Cases))
```


# Cases by Office Area

This section looks at the number of closed cases by the office area.

We can see that the Des Moines (026) office  has the most number of closed cases.

```{r Cases by Office Area, echo=FALSE}
office.cases <- IVRS %>%
  count(Office.Area, name = "Total.Cases") %>%
  group_by(Office.Area)
  

ggplot(data = office.cases, aes(x = reorder(Office.Area, -Total.Cases), y = Total.Cases)) +
  geom_bar(fill = "orange", stat = "identity") +
  geom_text(aes(label=Total.Cases), vjust=0) +
  xlab("Office") +
  ylab("Number of Cases") +
  theme(axis.text.x = element_text(angle = 30))
```


