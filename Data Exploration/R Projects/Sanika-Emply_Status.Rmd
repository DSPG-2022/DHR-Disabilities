---
title: "Employment Status"
output: html_document
date: '2022-06-17'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(tidycensus)
library(dplyr)
library(ggplot2)
```

```{r}
census_api_key("ab8b0fa7ef0993c579097beb76d0321bce5af443", install = TRUE)
```
```{r}
var<-load_variables(2020,"acs5")
View(var)
```

```{r}
emp_stat_disability <-c("In the Labor Force,Employed with disability"= "C18120_004", "In the Labor force,unemployed with a disability" = "C18120_007",  "Not in the Labor force, with a disability" = "C18120_010")

emp_stat_no_disability <- c("In the Labor Force,Employed with no disability"= "C18120_005", "In the Labor force,unemployed with no disability" = "C18120_008", "Not in the Labor Force, with no disability" = "C18120_011")
```

```{r}
empl_status_disability <- get_acs(
  geography= "county",
  year = 2020,
  variables = emp_stat_disability,
  state= "IA",
  output = "wide"
)
View(empl_status_disability)

#empl_status_disability= empl_status_disability %>% mutate(sum_of_estimates = sum (estimate),overall_perc= 100* (estimate/sum(estimate)) )
#View(empl_status_disability)

empl_status_no_disability <- get_acs(
  geography= "county",
  year = 2020,
  variables = emp_stat_no_disability,
  state= "IA",
  output= "wide"
)
View(empl_status_no_disability)

#empl_status_no_disability= empl_status_no_disability %>% mutate(sum_of_estimates= sum(estimate),overall_perc= 100* (estimate/sum(estimate))) 
#View(empl_status_no_disability)
```
```{r}
```

```{r}
all_emp_stat= full_join(empl_status_disability,empl_status_no_disability)
View(all_emp_stat)

all_emp_stat = drop(all_emp_stat, -c(`In the Labor Force,Employed with disabilityM`,`In the Labor force,unemployed with a disabilityM`,`Not in the Labor force, with a disabilityM`,`In the Labor Force,Employed with no disabilityM`,`In the Labor force,unemployed with no disabilityM`,`Not in the Labor Force, with no disabilityM`))
```

```{r}
all_emp_stat$in_labor_force_employed_gap <- (all_emp_stat$`In the Labor Force,Employed with no disabilityE`- all_emp_stat$`In the Labor Force,Employed with disabilityE`)
all_emp_stat$in_labor_force_unemployed_gap <- (all_emp_stat$`In the Labor force,unemployed with no disabilityE`- all_emp_stat$`In the Labor force,unemployed with a disabilityE`)
all_emp_stat$not_in_labor_force_gap <- (all_emp_stat$`Not in the Labor Force, with no disabilityE`- all_emp_stat$`Not in the Labor force, with a disabilityE`)
View(all_emp_stat)
```


```{r}
write.csv(all_emp_stat, "Employement_Status.csv") 

write.csv(all_emp_stat,"C:/Users/sanik/Documents/Cleaned_Employement_Cases.csv", row.names = FALSE)
```

```{r}


ggplot(all_emp_stat, aes(variable, weight= estimate))+
  geom_bar()+
  labs(x="Employment Status", y= "population",
       title= "Employement Status by Disability")+
  geom_errorbar((aes(ymin= estimate-moe,
                    ymax= estimate+moe)))
               
```
